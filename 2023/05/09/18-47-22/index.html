<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.16.0","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="加压可通过施加静水压强、调整晶格常数的方法实现结构压缩 vi INCAR 增加标签 PSTRESS&#x3D;50（单位为 0.1 GPa） 其他不变 加电场在vasp中根据自己所需要添加电场的场强更改INCAR中的如下参数： 123LDIPOL&#x3D;.TRUE.IDIPOL&#x3D;1&#x2F;2&#x2F;3&#x2F;4EFIELD&#x3D; ？ 对于IDIPOL参数的设置，需注意：对于IDIPOL&#x3D;1-3，偶极矩将分别平行于第一、第二或">
<meta property="og:type" content="article">
<meta property="og:title" content="1.3 结构优化3">
<meta property="og:url" content="http://example.com/2023/05/09/18-47-22/index.html">
<meta property="og:site_name" content="Lightchaser">
<meta property="og:description" content="加压可通过施加静水压强、调整晶格常数的方法实现结构压缩 vi INCAR 增加标签 PSTRESS&#x3D;50（单位为 0.1 GPa） 其他不变 加电场在vasp中根据自己所需要添加电场的场强更改INCAR中的如下参数： 123LDIPOL&#x3D;.TRUE.IDIPOL&#x3D;1&#x2F;2&#x2F;3&#x2F;4EFIELD&#x3D; ？ 对于IDIPOL参数的设置，需注意：对于IDIPOL&#x3D;1-3，偶极矩将分别平行于第一、第二或">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-05-09T10:47:22.000Z">
<meta property="article:modified_time" content="2024-06-05T02:05:13.685Z">
<meta property="article:author" content="Keke Liu">
<meta property="article:tag" content="vasp">
<meta property="article:tag" content="建模">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2023/05/09/18-47-22/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2023/05/09/18-47-22/","path":"2023/05/09/18-47-22/","title":"1.3 结构优化3"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>1.3 结构优化3 | Lightchaser</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Lightchaser</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">三人行，必有我师</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8A%A0%E5%8E%8B"><span class="nav-number">1.</span> <span class="nav-text">加压</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8A%A0%E7%94%B5%E5%9C%BA"><span class="nav-number">2.</span> <span class="nav-text">加电场</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E6%96%B9%E7%A8%8B%E6%8B%9F%E5%90%88"><span class="nav-number">3.</span> <span class="nav-text">状态方程拟合</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%A7%E8%87%B4%E6%B5%81%E7%A8%8B%EF%BC%88%E4%BB%A5%E5%A4%A7%E5%B8%88%E5%85%84%E6%8F%90%E4%BE%9B%E8%84%9A%E6%9C%AC%E4%B8%BA%E4%BE%8B%EF%BC%89"><span class="nav-number">3.0.1.</span> <span class="nav-text">大致流程（以大师兄提供脚本为例）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%86%E6%95%B0%E5%8D%A0%E6%8D%AE"><span class="nav-number">4.</span> <span class="nav-text">分数占据</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#disorder"><span class="nav-number">4.1.</span> <span class="nav-text">disorder</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">4.1.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E5%AD%901%EF%BC%9ASnxPb1-xTe"><span class="nav-number">4.1.2.</span> <span class="nav-text">例子1：SnxPb1-xTe</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B1%82%E9%97%B4%E7%BB%93%E5%90%88%E8%83%BD%E3%80%81%E7%BB%93%E5%90%88%E5%8A%9B"><span class="nav-number">5.</span> <span class="nav-text">层间结合能、结合力</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Graphite-interlayer-distance"><span class="nav-number">5.0.1.</span> <span class="nav-text">Graphite interlayer distance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Graphite-MBD-binding-energy"><span class="nav-number">5.0.2.</span> <span class="nav-text">Graphite MBD binding energy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Graphite-TS-binding-energy"><span class="nav-number">5.0.3.</span> <span class="nav-text">Graphite TS binding energy</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Keke Liu</p>
  <div class="site-description" itemprop="description">一个小学生的博客</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/stemdkk" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;stemdkk" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:257198@whut.edu.cn" title="E-Mail → mailto:257198@whut.edu.cn" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/09/18-47-22/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Keke Liu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lightchaser">
      <meta itemprop="description" content="一个小学生的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="1.3 结构优化3 | Lightchaser">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          1.3 结构优化3
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-05-09 18:47:22" itemprop="dateCreated datePublished" datetime="2023-05-09T18:47:22+08:00">2023-05-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-06-05 10:05:13" itemprop="dateModified" datetime="2024-06-05T10:05:13+08:00">2024-06-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DFT%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">DFT学习</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="加压"><a href="#加压" class="headerlink" title="加压"></a>加压</h1><p>可通过施加静水压强、调整晶格常数的方法实现结构压缩</p>
<p>vi INCAR 增加标签 <code>PSTRESS=50</code><br>（单位为 0.1 GPa）</p>
<p>其他不变</p>
<h1 id="加电场"><a href="#加电场" class="headerlink" title="加电场"></a>加电场</h1><p>在vasp中根据自己所需要添加电场的场强更改INCAR中的如下参数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LDIPOL=.TRUE.</span><br><span class="line">IDIPOL=1/2/3/4</span><br><span class="line">EFIELD= ？</span><br></pre></td></tr></table></figure>
<p>对于IDIPOL参数的设置，需注意：对于IDIPOL&#x3D;1-3，偶极矩将分别平行于第一、第二或第三晶格矢量的方向计算。总能量的修正计算为当前超单元中单极子&#x2F;偶极子和四极子与放置在超单元中的同一偶极子之间的能量差，对应的晶格矢量接近无穷大。此标志应用于板计算。对于IDIPOL&#x3D;4，将计算所有方向上的完整偶极矩，并将总能量的修正计算为当前超级单体中的单极&#x2F;偶极&#x2F;四极和放置在真空中的同一单极&#x2F;偶极&#x2F;四极之间的能量差，使用该标志计算孤立分子。</p>
<p>此外，EFIELD 的设置需要注意单位的换算。eV&#x2F;Å（电子伏特&#x2F;埃）计算完毕之后通过后处理软件分析所关注的性质即可。</p>
<h1 id="状态方程拟合"><a href="#状态方程拟合" class="headerlink" title="状态方程拟合"></a>状态方程拟合</h1><p>我们需要对结构进行优化才可以获取稳定的晶格参数信息。有两个方法可以实现：</p>
<p>1 Birch-Murnaghan状态方程拟合,<br>2 VASP计算中通过调节ISIF参数直接优化Bulk。<br>直接优化前面已经介绍，下面我们先讨论一下第一个方法：BM方程拟合。</p>
<p>参考：大师兄科研网：<a target="_blank" rel="noopener" href="https://www.bigbrosci.com/2018/02/02/ex33/">https://www.bigbrosci.com/2018/02/02/ex33/</a></p>
<p>科学网耿华运的博文：<a target="_blank" rel="noopener" href="https://blog.sciencenet.cn/blog-3469498-1280203.html">https://blog.sciencenet.cn/blog-3469498-1280203.html</a></p>
<p>科学网赵志强的博文，关于拟合：<a target="_blank" rel="noopener" href="https://wap.sciencenet.cn/blog-3388193-1152915.html">https://wap.sciencenet.cn/blog-3388193-1152915.html</a></p>
<p>vaspkit：<a target="_blank" rel="noopener" href="http://vaspkit.cn/index.php/48.html">http://vaspkit.cn/index.php/48.html</a></p>
<h3 id="大致流程（以大师兄提供脚本为例）"><a href="#大致流程（以大师兄提供脚本为例）" class="headerlink" title="大致流程（以大师兄提供脚本为例）"></a>大致流程（以大师兄提供脚本为例）</h3><ol>
<li><p>获得一定缩放系数的结构：<code>for i in 0.95 0.96 0.97 0.98 0.99 1.01 1.02 1.03 1.04 1.05; do cp 1.00 $i ; sed -i &quot;2s/1.0/$i/g&quot; $i/POSCAR ; done</code></p>
</li>
<li><p>分别进行结构优化:<code>for i in *; do cd $i; 提交任务命令; cd $OLDPWD; done</code></p>
</li>
<li><p>提取能量-体积以及能量-压力、压力-体积的数据:<code>for i in *; do echo -e $i &quot;\t&quot; $(grep &#39;  without&#39; $i/OUTCAR | tail -n 1| awk &#39;&#123;print $7&#125;&#39;);  done &gt; data</code></p>
</li>
<li><p>拟合能量体积曲线，获得平衡晶胞参数</p>
</li>
</ol>
<ul>
<li>这个流程可通过批量计算脚本实现，参考上面链接。另外还可以获得能量随压力的变化来模拟相变。</li>
</ul>
<h1 id="分数占据"><a href="#分数占据" class="headerlink" title="分数占据"></a>分数占据</h1><p>生成disorder或者掺杂构型的软件汇总：</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/vYar9UcYWAZgazBTgqUGEA">https://mp.weixin.qq.com/s/vYar9UcYWAZgazBTgqUGEA</a><br><a target="_blank" rel="noopener" href="https://github.com/jichunlian/disorder">https://github.com/jichunlian/disorder</a><br>supercell： <a target="_blank" rel="noopener" href="https://orex.github.io/supercell/">https://orex.github.io/supercell/</a><br>ATAT： <a target="_blank" rel="noopener" href="https://www.brown.edu/Departments/Engineering/Labs/avdw/atat/">https://www.brown.edu/Departments/Engineering/Labs/avdw/atat/</a><br>vaspkit：<a target="_blank" rel="noopener" href="https://vaspkit.com/">https://vaspkit.com/</a></p>
<h2 id="disorder"><a href="#disorder" class="headerlink" title="disorder"></a>disorder</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ unzip disorder-main</span><br><span class="line">$ cd disorder-main</span><br><span class="line">$ make disorder (Only disorder is compilied)</span><br><span class="line">$ make supercell (Only supercell is compilied)</span><br><span class="line">$ make or make all (Both disorder and supercell are compilied)</span><br><span class="line">$ make clean (rm *.o *.mod disorder supercell)</span><br><span class="line">export PATH=$PATH:disorder_installation_path/disorder-main/bin</span><br><span class="line">(Add this to the ~/.bashrc file as you wish)</span><br></pre></td></tr></table></figure>
<p>Note: The default compiler is ifort, and you can modify the Makefile<br>in the src directory to use another compiler (e.g. gfortran).</p>
<p>需要准备两个文件SPOSCAR和INDSOD,以examples的1和2为例：</p>
<h3 id="例子1：SnxPb1-xTe"><a href="#例子1：SnxPb1-xTe" class="headerlink" title="例子1：SnxPb1-xTe"></a>例子1：SnxPb1-xTe</h3><ol>
<li>扩建超胞，保证整除<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Te Pb</span><br><span class="line">   1.0</span><br><span class="line">    13.1323995589999996    0.0000000000000000    0.0000000000000000</span><br><span class="line">     0.0000000000000000   13.1323995589999996    0.0000000000000000</span><br><span class="line">     0.0000000000000000    0.0000000000000000   13.1323995589999996</span><br><span class="line">  Te   Pb</span><br><span class="line">  32   32</span><br><span class="line">Direct</span><br><span class="line">* * *</span><br></pre></td></tr></table></figure></li>
<li>准备INDSOD文件<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&amp;input</span><br><span class="line">  nsub = 2</span><br><span class="line">  subs = 16,16</span><br><span class="line">  symb = &#x27;Sn&#x27;,&#x27;Pb&#x27; ! The quotes is unnecessary for the ifort compiler</span><br><span class="line">  site = 2</span><br><span class="line">  prec = 1D-5</span><br><span class="line">! lpro = .true.</span><br><span class="line">! lpos = .true.</span><br><span class="line">! leqa = .true.</span><br><span class="line">! lspg = .true.</span><br><span class="line">  lcfg = .false.</span><br><span class="line">/</span><br></pre></td></tr></table></figure>
官方解释：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nsub-tag:nsub = 2 ~ 5; Default: nsub = 2.该位置取代原子种类。本例中是2种。</span><br><span class="line">subs-tag：subs = integer, integer, …; Default: None。对 应的原子数目。总和加起来应该等于该位点在SPOSCAR中的数目。</span><br><span class="line">symb-tag：symb = character, character, …; Default: None。元素化学符号。空位用Kw,即汉语kong wei。本例是Sn Pb单引号。</span><br><span class="line">site-tag：site = integer; Default: 1。所取代的位置在SPOSCAR中的位置。本例是2.</span><br><span class="line">prec-tag：prec = real; Default: 1D-5。当软件产生空间群与其他软件识别不一致时调整该参数，一般不用修改。</span><br><span class="line">lpro-tag：lpro = logical; Default: .false.是否消除重复参数。对于大体系可以打开。</span><br><span class="line">lpos、leqa、lspg、lcfg：分别控制输出文件POSCAR-X、EQAMAT、SPGMAT、CFGMAT。</span><br></pre></td></tr></table></figure></li>
<li>运行disorder。输入disorder即可。</li>
<li>输出文件：</li>
</ol>
<h1 id="层间结合能、结合力"><a href="#层间结合能、结合力" class="headerlink" title="层间结合能、结合力"></a>层间结合能、结合力</h1><p>贴一篇文章：<a target="_blank" rel="noopener" href="https://news.sciencenet.cn/htmlpaper/2022/4/202242914585844872440.shtm">https://news.sciencenet.cn/htmlpaper/2022/4/202242914585844872440.shtm</a></p>
<h3 id="Graphite-interlayer-distance"><a href="#Graphite-interlayer-distance" class="headerlink" title="Graphite interlayer distance"></a>Graphite interlayer distance</h3><p>vasp上的教程：</p>
<p>准备graphite结构，</p>
<p>INCAR：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">IVDW = 20           </span><br><span class="line">LVDW_EWALD =.TRUE. </span><br><span class="line">NSW = 1 </span><br><span class="line">IBRION = 2</span><br><span class="line">ISIF = 4</span><br><span class="line">PREC = Accurate</span><br><span class="line">EDIFFG = 1e-5</span><br><span class="line">LWAVE = .FALSE.</span><br><span class="line">LCHARG = .FALSE.</span><br><span class="line">ISMEAR = -5</span><br><span class="line">SIGMA = 0.01</span><br><span class="line">EDIFF = 1e-6</span><br><span class="line">ALGO = Fast</span><br><span class="line">NPAR = 2</span><br></pre></td></tr></table></figure>
<p>提交脚本：<br>To run this example, execute the run.sh bash-script:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line"># To run VASP this script calls $vasp_std</span><br><span class="line"># (or posibly $vasp_gam and/or $vasp_ncl).</span><br><span class="line"># These variables can be defined by sourcing vaspcmd</span><br><span class="line">. vaspcmd 2&gt; /dev/null</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># When vaspcmd is not available and $vasp_std,</span><br><span class="line"># $vasp_gam, and/or $vasp_ncl are not set as environment</span><br><span class="line"># variables, you can specify them here</span><br><span class="line">[ -z &quot;`echo $vasp_std`&quot; ] &amp;&amp; vasp_std=&quot;mpirun -np 8 /path-to-your-vasp/vasp_std&quot;</span><br><span class="line">[ -z &quot;`echo $vasp_gam`&quot; ] &amp;&amp; vasp_gam=&quot;mpirun -np 8 /path-to-your-vasp/vasp_gam&quot;</span><br><span class="line">[ -z &quot;`echo $vasp_ncl`&quot; ] &amp;&amp; vasp_ncl=&quot;mpirun -np 8 /path-to-your-vasp/vasp_ncl&quot;</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># The real work starts here</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">rm results.dat</span><br><span class="line"></span><br><span class="line">for d in 6.5 6.6 6.65 6.7 6.75 6.8 6.9 7.0</span><br><span class="line">do</span><br><span class="line">  cat&gt;POSCAR&lt;&lt;!</span><br><span class="line">graphite</span><br><span class="line">1.0</span><br><span class="line">1.22800000 -2.12695839  0.00000000</span><br><span class="line">1.22800000  2.12695839  0.00000000</span><br><span class="line">0.00000000  0.00000000  $d</span><br><span class="line">4</span><br><span class="line">direct</span><br><span class="line">   0.00000000  0.00000000  0.25000000</span><br><span class="line">   0.00000000  0.00000000  0.75000000</span><br><span class="line">   0.33333333  0.66666667  0.25000000</span><br><span class="line">   0.66666667  0.33333333  0.75000000</span><br><span class="line">!</span><br><span class="line">  $vasp_std</span><br><span class="line">  cp OUTCAR OUTCAR.$d</span><br><span class="line">  energy=$(grep &quot;free  ene&quot; OUTCAR.$d|awk &#x27;&#123;print $5&#125;&#x27;)</span><br><span class="line">  echo $d $energy &gt;&gt; results.dat </span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p>The optimal length of the lattice vector c normal to the stacking direction is determined in a series of single point calculations with varied value of c (all other degrees of freedom are fixed at their experimental values).</p>
<p>The computed c vs. energy dependence is written in the file results.dat and can be visualized e.g. using xmgrace. The optimal value can be obtained using the attached utility (python with numpy or Numeric is needed):</p>
<p><code>./utilities/fit.py results.dat</code><br>This should yield:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">200 iterations performed</span><br><span class="line">Ch-square: 4.30305519481e-09</span><br><span class="line">---------</span><br><span class="line"></span><br><span class="line">       E0(eV):         -37.433456779</span><br><span class="line">       d0(A):  6.65603352689</span><br><span class="line">The computed value of 6.66 Å agrees well with experiment (6.71 Å).</span><br></pre></td></tr></table></figure>

<h3 id="Graphite-MBD-binding-energy"><a href="#Graphite-MBD-binding-energy" class="headerlink" title="Graphite MBD binding energy"></a>Graphite MBD binding energy</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">IVDW = 202           </span><br><span class="line">LVDWEXPANSION =.TRUE. </span><br><span class="line">NSW = 1 </span><br><span class="line">IBRION = 2</span><br><span class="line">ISIF = 4</span><br><span class="line">PREC = Accurate</span><br><span class="line">EDIFFG = 1e-5</span><br><span class="line">LWAVE = .FALSE.</span><br><span class="line">LCHARG = .FALSE.</span><br><span class="line">ISMEAR = -5</span><br><span class="line">SIGMA = 0.01</span><br><span class="line">EDIFF = 1e-6</span><br><span class="line">ALGO = Fast</span><br><span class="line">NPAR = 2</span><br></pre></td></tr></table></figure>
<p>KPOINTS</p>
<p>Graphite:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Monkhorst Pack</span><br><span class="line">0</span><br><span class="line">gamma</span><br><span class="line">16 16 8</span><br><span class="line">0 0 0</span><br></pre></td></tr></table></figure>
<p>Graphene:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Monkhorst Pack</span><br><span class="line">0</span><br><span class="line">gamma</span><br><span class="line">16 16 1</span><br><span class="line">0 0 0</span><br></pre></td></tr></table></figure>
<p>Running this example<br>To run this example, execute the run.sh bash-script:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line"># To run VASP this script calls $vasp_std</span><br><span class="line"># (or posibly $vasp_gam and/or $vasp_ncl).</span><br><span class="line"># These variables can be defined by sourcing vaspcmd</span><br><span class="line">. vaspcmd 2&gt; /dev/null</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># When vaspcmd is not available and $vasp_std,</span><br><span class="line"># $vasp_gam, and/or $vasp_ncl are not set as environment</span><br><span class="line"># variables, you can specify them here</span><br><span class="line">[ -z &quot;`echo $vasp_std`&quot; ] &amp;&amp; vasp_std=&quot;mpirun -np 8 /path-to-your-vasp/vasp_std&quot;</span><br><span class="line">[ -z &quot;`echo $vasp_gam`&quot; ] &amp;&amp; vasp_gam=&quot;mpirun -np 8 /path-to-your-vasp/vasp_gam&quot;</span><br><span class="line">[ -z &quot;`echo $vasp_ncl`&quot; ] &amp;&amp; vasp_ncl=&quot;mpirun -np 8 /path-to-your-vasp/vasp_ncl&quot;</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># The real work starts here</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"># Here the work starts</span><br><span class="line">rm results.dat</span><br><span class="line"></span><br><span class="line">drct=$(pwd)</span><br><span class="line"></span><br><span class="line">for i in graphene graphite</span><br><span class="line">do</span><br><span class="line">  cd $drct/$i</span><br><span class="line">  $vasp_std</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">cd $drct</span><br><span class="line"></span><br><span class="line"># obtain total energy for graphite </span><br><span class="line">en2=$(grep &quot;free  ene&quot; graphite/OUTCAR |tail -1|awk &#x27;&#123;print $5&#125;&#x27;) </span><br><span class="line"></span><br><span class="line"># obtain total energy for graphene</span><br><span class="line">en1=$(grep &quot;free  ene&quot; graphene/OUTCAR |tail -1|awk &#x27;&#123;print $5&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"># compute interlayer binding energy (eV/atom)</span><br><span class="line">deltaE=$(echo print $en2/4 - $en1/2 |python)</span><br><span class="line"></span><br><span class="line">echo &quot;Binding energy (eV/atom): &quot; $deltaE &gt;results.dat</span><br></pre></td></tr></table></figure>

<p>Note that the calculation is performed in two steps (two separate single-point calculations) in which the energy for bulk graphite and for graphene are obtained. The binding energy is computed automatically and it is written in the file results.dat. (N.B.: for the latter python needs to be available.)</p>
<p>The computed value of 0.050 eV&#x2F;A is now fairly close to the RPA reference of 0.048 eV&#x2F;atom [1].</p>
<h3 id="Graphite-TS-binding-energy"><a href="#Graphite-TS-binding-energy" class="headerlink" title="Graphite TS binding energy"></a>Graphite TS binding energy</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">IVDW = 20            </span><br><span class="line">LVDW_EWALD =.TRUE. </span><br><span class="line">NSW = 1 </span><br><span class="line">IBRION = 2</span><br><span class="line">ISIF = 4</span><br><span class="line">PREC = Accurate</span><br><span class="line">EDIFFG = 1e-5</span><br><span class="line">LWAVE = .FALSE.</span><br><span class="line">LCHARG = .FALSE.</span><br><span class="line">ISMEAR = -5</span><br><span class="line">SIGMA = 0.01</span><br><span class="line">EDIFF = 1e-6</span><br><span class="line">ALGO = Fast</span><br><span class="line">NPAR = 2</span><br></pre></td></tr></table></figure>
<p>To run this example, execute the run.sh bash-script:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line"># To run VASP this script calls $vasp_std</span><br><span class="line"># (or posibly $vasp_gam and/or $vasp_ncl).</span><br><span class="line"># These variables can be defined by sourcing vaspcmd</span><br><span class="line">. vaspcmd 2&gt; /dev/null</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># When vaspcmd is not available and $vasp_std,</span><br><span class="line"># $vasp_gam, and/or $vasp_ncl are not set as environment</span><br><span class="line"># variables, you can specify them here</span><br><span class="line">[ -z &quot;`echo $vasp_std`&quot; ] &amp;&amp; vasp_std=&quot;mpirun -np 8 /path-to-your-vasp/vasp_std&quot;</span><br><span class="line">[ -z &quot;`echo $vasp_gam`&quot; ] &amp;&amp; vasp_gam=&quot;mpirun -np 8 /path-to-your-vasp/vasp_gam&quot;</span><br><span class="line">[ -z &quot;`echo $vasp_ncl`&quot; ] &amp;&amp; vasp_ncl=&quot;mpirun -np 8 /path-to-your-vasp/vasp_ncl&quot;</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># The real work starts here</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">rm results.dat</span><br><span class="line"></span><br><span class="line">drct=$(pwd)</span><br><span class="line"></span><br><span class="line">for i in graphene graphite</span><br><span class="line">do</span><br><span class="line">  cd $drct/$i</span><br><span class="line">  $vasp_std</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">cd $drct</span><br><span class="line"></span><br><span class="line"># obtain total energy for graphite </span><br><span class="line">en2=$(grep &quot;free  ene&quot; graphite/OUTCAR |tail -1|awk &#x27;&#123;print $5&#125;&#x27;) </span><br><span class="line"></span><br><span class="line"># obtain total energy for graphene</span><br><span class="line">en1=$(grep &quot;free  ene&quot; graphene/OUTCAR |tail -1|awk &#x27;&#123;print $5&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"># compute interlayer binding energy (eV/atom)</span><br><span class="line">deltaE=$(echo print $en2/4 - $en1/2 |python)</span><br><span class="line"></span><br><span class="line">echo &quot;Binding energy (eV/atom): &quot; $deltaE &gt;results.dat</span><br></pre></td></tr></table></figure>

<p>Note that the calculation is performed in two steps (two separate single-point calculations) in which the energy for bulk graphite and for graphene are obtained. The binding energy is computed automatically and it is written in the file results.dat. (N.B.: for the latter python needs to be available.)</p>
<p>Even though the TS method predicts a reasonable geometry (see the Graphite interlayer distance example) it overestimates the energetics strongly: the computed binding energy of -0.083 eV&#x2F;atom is too large compared to the RPA reference of 0.048 eV&#x2F;atom. This overestimation is - at least in part - due to neglecting the many-body interactions (see example Graphite MBD binding energy).</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/vasp/" rel="tag"># vasp</a>
              <a href="/tags/%E5%BB%BA%E6%A8%A1/" rel="tag"># 建模</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/05/09/18-47-21/" rel="prev" title="1.2 结构优化2">
                  <i class="fa fa-chevron-left"></i> 1.2 结构优化2
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/05/09/18-47-23/" rel="next" title="1.4 过渡态">
                  1.4 过渡态 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Keke Liu</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
